const b=function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))n(e);new MutationObserver(e=>{for(const h of e)if(h.type==="childList")for(const c of h.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function t(e){const h={};return e.integrity&&(h.integrity=e.integrity),e.referrerpolicy&&(h.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?h.credentials="include":e.crossorigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function n(e){if(e.ep)return;e.ep=!0;const h=t(e);fetch(e.href,h)}};b();const d="#ffffff";document.querySelector("#app");const C=document.querySelector("#scoreEl"),x=document.querySelector("#resultEl"),p={over:!1,active:!0},r=document.querySelector("canvas");r.width=1024;r.height=576;const{left:E,top:L}=r.getBoundingClientRect(),s=r.getContext("2d"),g=100;let f=0;s.globalCompositeOperation="source-over";s.fillStyle="rgba(0, 0, 0, 0.3)";s.fillRect(0,0,r.width,r.height);s.globalCompositeOperation="lighter";function T(){var o=Math.random()*255>>0,i=Math.random()*255>>0,t=Math.random()*255>>0;return"rgba("+o+", "+i+", "+t+", 0.5)"}class F{constructor(){this.color="red",this.radius=50,this.position={x:r.width/2,y:r.height/2},this.projectiles=[],this.opacity=1}draw(){s.save(),s.globalAlpha=this.opacity,s.beginPath();const i=s.createRadialGradient(this.position.x,this.position.y,0,this.position.x,this.position.y,this.radius);i.addColorStop(0,d),i.addColorStop(.4,d),i.addColorStop(.4,this.color),i.addColorStop(1,"black"),s.fillStyle=i,s.arc(this.position.x,this.position.y,this.radius,0,Math.PI*2),s.fill(),s.closePath(),s.restore()}shoot({x:i,y:t}){this.projectiles.push(new v({position:this.position,target:{x:i,y:t}}))}hide(i){this.opacity=0;for(let t=0;t<100;t++)i.push(new m({color:d,position:{x:this.position.x,y:this.position.y}}))}}class v{constructor({position:i,target:t,color:n,radius:e}){this.radius=e||12,this.color=n||d,this.position={x:i.x,y:i.y},this.target={x:t.x,y:t.y},this.velocity={x:(this.position.x-this.target.x)/g*-1,y:(this.position.y-this.target.y)/g*-1},this.opacity=1}draw(){s.save(),s.globalAlpha=this.opacity,s.fillStyle=this.color,s.beginPath(),s.arc(this.position.x,this.position.y,this.radius,0,Math.PI*2,!1),s.fill(),s.closePath(),s.restore()}update(){this.draw(),Math.abs(this.position.x-this.target.x)>1||Math.abs(this.position.y-this.target.y)>1?(this.position.x+=this.velocity.x,this.position.y+=this.velocity.y):(this.velocity.x=0,this.velocity.y=0,this.opacity=0)}}class R{constructor({position:i,velocity:t,color:n,radius:e}){this.position={x:i.x,y:i.y},this.velocity={x:t.x,y:t.y},this.radius=e,this.color=n,this.projectiles=[]}draw(){s.save(),s.globalAlpha=this.opacity;const i=s.createRadialGradient(this.position.x,this.position.y,0,this.position.x,this.position.y,this.radius);i.addColorStop(0,d),i.addColorStop(.4,d),i.addColorStop(.4,this.color),i.addColorStop(1,"black"),s.fillStyle=i,s.beginPath(),s.arc(this.position.x,this.position.y,this.radius,0,Math.PI*2,!1),s.fill(),s.closePath(),s.restore()}update(){this.draw(),this.position.x+=this.velocity.x,this.position.y+=this.velocity.y}shoot(){this.projectiles.push(new v({position:this.position,color:"yellow",target:{x:a.position.x,y:a.position.y}}))}hide(i){this.opacity=0;for(let t=0;t<100;t++)i.push(new m({color:this.color,position:{x:this.position.x,y:this.position.y}}))}}class m{constructor({position:i,color:t}){this.position={x:i.x,y:i.y},this.velocity={x:Math.floor([-1,1][Math.random()*2|0]*(Math.random()*10)),y:Math.floor([-1,1][Math.random()*2|0]*(Math.random()*10))},this.color=t,this.radius=Math.random()*5,this.opacity=1}draw(){s.save(),s.globalAlpha=this.opacity,s.fillStyle=this.color,s.beginPath(),s.arc(this.position.x,this.position.y,this.radius,0,Math.PI*2,!1),s.fill(),s.closePath(),s.restore()}update(){this.draw(),this.position.x+=this.velocity.x,this.position.y+=this.velocity.y,this.opacity>0?this.opacity-=.05:this.opacity=0}}const a=new F,l=[],u=[];let M=0,y=1;function w(){!p.active||(requestAnimationFrame(w),s.clearRect(0,0,r.width,r.height),a.draw(),l.forEach((o,i)=>{o.position.x+o.radius>=r.width||o.position.x-o.radius<=0||o.position.y+o.radius>=r.height||o.position.y-o.radius<=0?setTimeout(()=>{l.splice(i,1)},0):(o.update(),o.projectiles.forEach((t,n)=>{t.position.x+t.radius<=a.position.x+a.radius&&t.position.x-t.radius>=a.position.x-a.radius&&t.position.y+t.radius<=a.position.y+a.radius&&t.position.y-t.radius>=a.position.y-a.radius?(S("you lose"),p.over=!0,a.hide(u),setTimeout(()=>{p.active=!1},3e3)):t.opacity===0?setTimeout(()=>{o.projectiles.splice(n,1)},0):t.update()}),a.projectiles.forEach((t,n)=>{o.position.x+o.radius>=t.position.x+t.radius&&o.position.x-o.radius<=t.position.x-t.radius&&o.position.y+o.radius>=t.position.y+t.radius&&o.position.y-o.radius<=t.position.y-t.radius?(o.hide(u),A(),setTimeout(()=>{a.projectiles.find(c=>c===t)&&a.projectiles.splice(n,1),l.find(c=>c===o)&&l.splice(i,1)},0)):t.opacity===0?setTimeout(()=>{a.projectiles.splice(n,1)},0):t.update()}))}),u.forEach((o,i)=>{o.opacity===0?setTimeout(()=>{u.splice(i,1)},0):o.update()}),M%10==0&&l.push(new R({position:{x:Math.random()*r.width,y:Math.random()*r.height},color:T(),radius:Math.random()*10+20,velocity:{x:Math.round(Math.random()*-10+5),y:Math.round(Math.random()*-10+5)}})),y%1e3==0&&(l[Math.floor(Math.random()*l.length)].shoot(),y=1),f>=1e3&&(p.over=!0,l.forEach(o=>o.hide(u)),setTimeout(()=>{p.active=!1},1e3),S("you win")),M++,y++)}w();function q({clientX:o,clientY:i,preventDefault:t}){p.over||a.shoot({x:o-E,y:i-L})}function A(o=100){f+=o,C.innerHTML=f.toString()}function S(o){x.innerHTML=o,x.classList.remove("hide")}addEventListener("mousedown",q);
